#!/usr/bin/env node
/**
 * Generate blank CATALOG TEMPLATE Excel file for user upload
 * Users can fill this with their custom cable ratings
 */

import XLSX from 'xlsx';
import path from 'path';
import fs from 'fs';

const wb = XLSX.utils.book_new();

// Sheet 1: 2C cables
const sheet2C = [
  ['2-Core Cable', '600/1100V XLPE @ 90°C'],
  ['Size mm²', 'Air (A)', 'Trench (A)', 'Duct (A)', 'Resistance 90°C (Ω/km)', 'Reactance (Ω/km)', 'Cable Dia (mm)'],
  ['2.5', 39, 47, 40, 9.450, 0.1070, 12],
  ['4', 52, 63, 52, 5.880, 0.0930, 13],
  ['6', 67, 79, 66, 3.930, 0.0890, 14.2],
  ['10', 90, 106, 87, 2.330, 0.0840, 15.6],
  ['16', 120, 137, 112, 1.470, 0.0810, 17.8],
  ['25', 156, 177, 144, 0.927, 0.0810, 21],
  ['35', 193, 212, 173, 0.668, 0.0790, 23.2],
  ['50', 232, 252, 205, 0.494, 0.0750, 26.3],
  ['70', 292, 308, 253, 0.342, 0.0740, 29.9],
  ['95', 360, 371, 304, 0.247, 0.0730, 33.9],
  ['120', 416, 420, 347, 0.197, 0.0720, 37.5],
  ['150', 353, 471, 390, 0.160, 0.0720, 41.5],
  ['185', 548, 531, 442, 0.128, 0.0720, 45.7],
  ['240', 658, 615, 512, 0.0986, 0.0920, 51.5],
  ['300', 745, 688, 575, 0.0800, 0.0900, 56.1],
  ['400', 867, 776, 650, 0.0640, 0.0900, 63.3]
];

const sheet3C = [
  ['3-Core Cable', '600/1100V XLPE @ 90°C'],
  ['Size mm²', 'Air (A)', 'Trench (A)', 'Duct (A)', 'Resistance 90°C (Ω/km)', 'Reactance (Ω/km)', 'Cable Dia (mm)'],
  ['1.5', 24, 32, 25, 15.43, 0.115, 11.7],
  ['2.5', 33, 41, 33, 9.450, 0.1070, 12.6],
  ['4', 45, 53, 44, 5.880, 0.0930, 13.7],
  ['6', 56, 67, 54, 3.930, 0.0890, 15.0],
  ['10', 78, 89, 73, 2.330, 0.0840, 16.5],
  ['16', 101, 115, 94, 1.470, 0.0810, 18.9],
  ['25', 133, 148, 121, 0.927, 0.0810, 19.9],
  ['35', 163, 177, 145, 0.668, 0.0790, 22.3],
  ['50', 199, 211, 172, 0.494, 0.0750, 25.5],
  ['70', 250, 259, 211, 0.342, 0.0740, 28.2],
  ['95', 309, 310, 255, 0.247, 0.0730, 32.2],
  ['120', 357, 353, 292, 0.197, 0.0720, 35.8],
  ['150', 409, 394, 329, 0.160, 0.0720, 39.0],
  ['185', 471, 445, 372, 0.128, 0.0720, 43.6],
  ['240', 556, 514, 429, 0.0986, 0.0920, 49.6],
  ['300', 633, 575, 483, 0.0800, 0.0900, 54.2],
  ['400', 728, 649, 554, 0.0640, 0.0900, 61.8]
];

const sheet4C = [
  ['4-Core Cable', '600/1100V XLPE @ 90°C'],
  ['Size mm²', 'Air (A)', 'Trench (A)', 'Duct (A)', 'Resistance 90°C (Ω/km)', 'Reactance (Ω/km)', 'Cable Dia (mm)'],
  ['2.5', 33, 33, 33, 9.450, 0.1070, 13.6],
  ['4', 45, 45, 44, 5.880, 0.0930, 14.8],
  ['6', 56, 56, 54, 3.930, 0.0890, 16.2],
  ['10', 78, 78, 73, 2.330, 0.0840, 17.9],
  ['16', 101, 101, 94, 1.470, 0.0810, 20.6],
  ['25', 133, 148, 121, 0.927, 0.0810, 22.0],
  ['35', 163, 177, 145, 0.668, 0.0790, 25.4],
  ['50', 199, 211, 172, 0.494, 0.0750, 28.3],
  ['70', 250, 259, 211, 0.342, 0.0740, 32.1],
  ['95', 309, 310, 255, 0.247, 0.0730, 36.3],
  ['120', 357, 353, 292, 0.197, 0.0720, 39.7],
  ['150', 409, 394, 329, 0.160, 0.0720, 44.8],
  ['185', 471, 445, 372, 0.128, 0.0720, 49.7],
  ['240', 556, 514, 429, 0.0986, 0.0920, 54.8],
  ['300', 633, 575, 483, 0.0800, 0.0900, 60.6],
  ['400', 728, 649, 554, 0.0640, 0.0900, 67.8]
];

const sheet1C = [
  ['Single-Core Cable', '600/1100V XLPE @ 90°C'],
  ['Size mm²', 'Air (A)', 'Trench (A)', 'Duct (A)', 'Resistance 90°C (Ω/km)', 'Reactance (Ω/km)', 'Cable Dia (mm)'],
  ['120', 400, 375, 356, 0.1970, 0.0970, 19.6],
  ['150', 460, 419, 385, 0.1600, 0.0970, 21.6],
  ['185', 528, 471, 425, 0.1280, 0.0960, 23.6],
  ['240', 622, 542, 476, 0.0986, 0.0920, 26.5],
  ['300', 709, 606, 519, 0.0800, 0.0900, 28.9],
  ['400', 810, 671, 551, 0.0640, 0.0900, 32.4],
  ['500', 916, 744, 598, 0.0525, 0.0890, 36.0],
  ['630', 1032, 817, 645, 0.0428, 0.0860, 42.4]
];

const sheetDerating = [
  ['DERATING FACTORS (K)', 'Multiplier'],
  ['Temperature (XLPE @ 55°C ambient)', ''],
  ['  - Air installation', 0.90],
  ['  - Trench installation', 0.90],
  ['  - Duct installation', 0.80],
  ['', ''],
  ['Grouping (single feeder)', 1.00],
  ['Grouping (2 feeders)', 0.95],
  ['Grouping (3 feeders)', 0.90],
  ['Grouping (4+ feeders)', 0.85],
  ['', ''],
  ['Ground temperature (35°C)', 0.96],
  ['Depth of laying (1200mm)', 1.00],
  ['Thermal resistivity (1.2 °C.m/W)', 1.00]
];

XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(sheet2C), '2C');
XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(sheet3C), '3C');
XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(sheet4C), '4C');
XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(sheet1C), '1C');
XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(sheetDerating), 'Derating');

const outFile = path.join(process.cwd(), '..', 'CATALOG_TEMPLATE.xlsx');
XLSX.writeFile(wb, outFile);
console.log('✅ Catalog template generated:', outFile);
